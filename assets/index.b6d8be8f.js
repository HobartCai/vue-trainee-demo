import{d as E,a as b,o as _,c as v,w as i,b as g,n as x,t as B,e as T,r as S,F as U,u as o,N as G,f as z,g as W,h as C,i as y,j as I,E as q,k as Z,D as Q,l as k,m as X,p as c,q as V,s as P,v as ee,x as te,y as D,z as ae,A as R,B as w,C as se,G as oe,H as re,I as le,J as ne,K as $,L as ue,M as ie,O as Y,P as de,Q as pe,R as ce,S as fe,T as me,U as _e,V as he,W as Ee,X as ye}from"./vendor.de21b0de.js";const ve=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))p(a);new MutationObserver(a=>{for(const u of a)if(u.type==="childList")for(const r of u.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&p(r)}).observe(document,{childList:!0,subtree:!0});function s(a){const u={};return a.integrity&&(u.integrity=a.integrity),a.referrerpolicy&&(u.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?u.credentials="include":a.crossorigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function p(a){if(a.ep)return;a.ep=!0;const u=s(a);fetch(a.href,u)}};ve();var f;(function(e){e.SECOND="second",e.MINUTE="minute",e.HOUR="hour",e.DAY="day",e.WEEK="week",e.MONTH="month",e.YEAR="year"})(f||(f={}));var h;(function(e){e.NON_REPEAT="nonRepeat",e.PER_DAY="perDay",e.PER_WEEK="perWeek",e.CUSTOM="CUSTOM"})(h||(h={}));var F;(function(e){e.CREATE="create",e.UPDATE="update"})(F||(F={}));const Fe=["#FF6666","#006699","#339933","#CCCC00","#FF9933","#663399","#CC3333","#FFCCCC","#99CC00"];function be(e,t,s){const{times:p,gap:a,unit:u}=t.repeat;for(let r=0;r<p+1;r++){const n=E.unix(t.start).add(r*a,u);if(n.isSame(e,s))return{start:E.unix(t.start).add(r*a,u),end:E.unix(t.end).add(r*a,u)};if(n.isAfter(e))return}}function K(e){return{[f.SECOND]:"\u79D2",[f.MINUTE]:"\u5206\u949F",[f.HOUR]:"\u5C0F\u65F6",[f.DAY]:"\u5929",[f.WEEK]:"\u5468",[f.MONTH]:"\u6708",[f.YEAR]:"\u5E74"}[e]}function Me(e,t){return e<1?"\u65E0\u91CD\u590D":e===1?`\u6BCF${K(t)}`:`\u6BCF${e}${K(t)}`}var A=(e,t)=>{const s=e.__vccOpts||e;for(const[p,a]of t)s[p]=a;return s};const Ce={class:"calendar-item"},Te={class:"calendar-item-text"},Ae=b({props:{start:null,end:null,title:null,style:null,popText:null},setup(e){const t=e;return(s,p)=>(_(),v(o(G),{trigger:"hover"},{trigger:i(()=>[g("div",Ce,[g("div",{class:"calendar-item-point",style:x(t.style)},null,4),g("div",null,[g("span",Te,B(t.title),1)])])]),default:i(()=>[(_(!0),T(U,null,S(t.popText,a=>(_(),T("span",{key:a,class:"calendar-item-pop-text"},B(a),1))),128))]),_:1}))}});var Ne=A(Ae,[["__scopeId","data-v-4af7c63c"]]);const j="SCHEDULE_JOBS",d={state:z({jobs:[],formModal:{visible:!1,mode:F.CREATE,initIndex:NaN,values:{title:"",range:[E().unix()*1e3,E().unix()*1e3],associates:[],repeatMode:h.NON_REPEAT,repeatTimes:0,repeatGap:0,repeatUnit:f.DAY}}}),setJobs(e){this.state.jobs=e,this.sort()},sort(){this.state.jobs.sort(function(e,t){const s=E.unix(e.start).unix(),p=E.unix(t.start).unix();return s-p})},addJob(e){this.state.jobs=this.state.jobs.concat(e),this.sort(),this.saveToLocalStorage()},removeJob(e){this.state.jobs.splice(e,1),this.saveToLocalStorage()},getAssociates(){const e=new Set;return this.state.jobs.forEach(t=>{t.associates.forEach(s=>{e.add(s)})}),e},setFormModalMode(e,t){switch(this.state.formModal.mode=e,e){case F.UPDATE:t!==void 0&&(this.setFormModalInitIndex(t),this.initFormValues());break;case F.CREATE:this.resetFormValues();break}this.setFormModalVisible(!0)},setFormModalVisible(e){this.state.formModal.visible=e},setFormModalInitIndex(e){this.state.formModal.initIndex=e},updateFormValuesByKey(e,t){this.state.formModal.values[e]=t},initFormValues(){const e=this.state.jobs[this.state.formModal.initIndex];this.state.formModal.values.title=e.title,this.state.formModal.values.range=[e.start*1e3,e.end*1e3],this.state.formModal.values.associates=e.associates,this.state.formModal.values.repeatGap=e.repeat.gap,this.state.formModal.values.repeatTimes=e.repeat.times,this.state.formModal.values.repeatUnit=e.repeat.unit,e.isPreset&&e.preset&&(this.state.formModal.values.repeatMode=e.preset)},resetFormValues(){this.state.formModal.values.title="",this.state.formModal.values.range=[E().unix()*1e3,E().unix()*1e3],this.state.formModal.values.associates=[],this.state.formModal.values.repeatMode=h.NON_REPEAT,this.state.formModal.values.repeatGap=0,this.state.formModal.values.repeatTimes=0,this.state.formModal.values.repeatUnit=f.DAY},submitFormValues(){this.state.formModal.mode===F.UPDATE&&this.removeJob(this.state.formModal.initIndex);const e=this.state.formModal.values,t=e.repeatMode!==h.CUSTOM,s={title:e.title,associates:e.associates,start:e.range[0]/1e3,end:e.range[1]/1e3,repeat:{times:e.repeatTimes,gap:e.repeatGap,unit:e.repeatUnit},isPreset:t};t&&(s.preset=e.repeatMode),this.addJob(s)},saveToLocalStorage(){try{window.localStorage.setItem(j,JSON.stringify(this.state.jobs))}catch(e){alert(e)}},loadFromLocalStorage(){try{const e=window.localStorage.getItem(j);e&&(this.state.jobs=JSON.parse(e))}catch(e){alert(e)}}};const ge=b({setup(e){const t="680px";function s(p,a,u){const r=E(`${p}-${a}-${u}`),n=[];return d.state.jobs.forEach((l,m)=>{const M=be(r,l,f.DAY);M&&n.push({title:l.title,start:M.start,end:M.end,style:{backgroundColor:Fe[m]},popText:[l.title,`${M.start.format("HH:mm")} ~ ${M.end.format("HH:mm")}`,l.associates.join(", ")]})}),n}return(p,a)=>(_(),v(o(W),{style:x({height:t})},{default:i(({year:u,month:r,date:n})=>[(_(!0),T(U,null,S(s(u,r,n),(l,m)=>(_(),v(Ne,{key:m,title:l.title,start:l.start,end:l.end,style:x(l.style),"pop-text":l.popText},null,8,["title","start","end","style","pop-text"]))),128))]),_:1},8,["style"]))}});var De=A(ge,[["__scopeId","data-v-6df17b9f"]]);const xe=b({setup(e){const t=C(()=>s(d.state.jobs));function s(p){const a=[{title:"\u8BFE\u7A0B",key:"title"},{title:"\u65E5\u671F",key:"date"},{title:"\u65F6\u95F4\u6BB5",key:"range"},{title:"\u5B66\u751F",key:"students"},{title:"\u9891\u6B21",key:"frequency"},{title:"\u7ED3\u675F\u65E5\u671F",key:"done"},{title:"\u64CD\u4F5C",key:"handle"}],u=p.map((r,n)=>{const{title:l,start:m,end:M,associates:J,repeat:{times:H,gap:O,unit:L}}=r;return{title:l,date:E.unix(m).format("YYYY-MM-DD"),range:`${E.unix(m).format("HH:mm")} ~ ${E.unix(M).format("HH:mm")}`,students:J.join(", "),frequency:Me(O,L),done:E.unix(m).add((H-1)*O,L).format("YYYY-MM-DD"),handle:y(k,{style:"padding-top:8px"},()=>[y(I,{size:15,onClick:()=>{d.setFormModalMode(F.UPDATE,n)}},()=>[y(q)]),y(Z,{onPositiveClick:()=>{d.removeJob(n)}},{trigger:()=>y(I,{size:15},()=>[y(Q)]),default:()=>"\u5220\u9664\u540E\u4E0D\u53EF\u6062\u590D\uFF0C\u786E\u8BA4\u662F\u5426\u5220\u9664?"})])}});return{columns:a,data:u}}return(p,a)=>(_(),v(o(X),{columns:o(t).columns,data:o(t).data},null,8,["columns","data"]))}});var Se=A(xe,[["__scopeId","data-v-c62fe996"]]);const Ue=D("\u8BFE\u7A0B\u8868"),Ve=D("\u65B0\u589E"),Oe=b({setup(e){function t(){d.setFormModalMode(F.CREATE)}return(s,p)=>(_(),v(o(te),null,{header:i(()=>[Ue]),"header-extra":i(()=>[c(o(V),{type:"info",onClick:t},{default:i(()=>[Ve]),_:1})]),default:i(()=>[c(o(ee),{type:"line"},{default:i(()=>[c(o(P),{name:"\u8868"},{default:i(()=>[c(Se)]),_:1}),c(o(P),{name:"\u65E5\u5386"},{default:i(()=>[c(De)]),_:1})]),_:1})]),_:1}))}});var Le=A(Oe,[["__scopeId","data-v-a0181476"]]);const Be="top",Ie=1,ke=0,Pe="end",Re="medium";var N=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",DEFAULT_LABEL_PLACEMENT:Be,DEFAULT_ITEM_SPAN:Ie,DEFAULT_ITEM_OFFSET:ke,DEFAULT_ACTION_JUSTIFY:Pe,DEFAULT_COMPONENT_SIZE:Re});const we=D("\u53D6\u6D88"),$e=D("\u786E\u8BA4"),Ye=b({props:{items:null,formValue:null,confirmText:null,cancelText:null,actionJustify:null},emits:["confirm","cancel","valueChange","update:formValue"],setup(e,{emit:t}){const s=e,p=ae(null);function a(r,n){return l=>{s.formValue[r]=l,n&&n()}}const u={input:r=>y(le,{onUpdateValue:a(r.path)}),"input-number":r=>y(ne,{onUpdateValue:a(r.path)}),select:r=>y($,{options:o(r.option),onUpdateValue:a(r.path)}),"select-multiple":r=>y($,{multiple:!0,tag:!0,filterable:!0,onUpdateValue:a(r.path),options:o(r.option)}),"radio-group":r=>y(ie,{onUpdateValue:a(r.path)},()=>{var n;return(n=o(r.option))==null?void 0:n.map(({label:l,value:m})=>y(ue,{key:m,value:m},()=>l))}),"date-picker":r=>y(Y,{onUpdateValue:a(r.path)}),"date-time-range":r=>y(Y,{type:"datetimerange",onUpdateValue:a(r.path)})};return(r,n)=>(_(),v(o(se),{ref_key:"formRef",ref:p,"label-placement":s.labelPlacement?o(s.labelPlacement):o(N).DEFAULT_LABEL_PLACEMENT},{default:i(()=>[c(o(w),{"x-gap":12},{default:i(()=>[(_(!0),T(U,null,S(s.items,(l,m)=>(_(),v(o(oe),{key:m,label:l.label,span:l.span?l.span:o(N).DEFAULT_ITEM_SPAN,offset:l.offset?l.offset:o(N).DEFAULT_ITEM_OFFSET,size:l.size?l.size:o(N).DEFAULT_COMPONENT_SIZE},{default:i(()=>[(_(),v(re(u[l.type](l)),{value:s.formValue[l.path],"default-value":s.formValue[l.path],disabled:o(l.disabled)},null,8,["value","default-value","disabled"]))]),_:2},1032,["label","span","offset","size"]))),128)),c(o(R),{span:24},{default:i(()=>[c(o(k),{justify:s.actionJustify?s.actionJustify:o(N).DEFAULT_ACTION_JUSTIFY},{default:i(()=>[c(o(V),{onClick:n[0]||(n[0]=l=>t("cancel"))},{default:i(()=>[we]),_:1}),c(o(V),{type:"info",onClick:n[1]||(n[1]=l=>t("confirm"))},{default:i(()=>[$e]),_:1})]),_:1},8,["justify"])]),_:1})]),_:1})]),_:1},8,["label-placement"]))}}),Ke=b({emits:["confirm"],setup(e,{emit:t}){const s=de(d.state.formModal,"values"),p=C(()=>({[F.CREATE]:"\u65B0\u589E",[F.UPDATE]:"\u7F16\u8F91"})[d.state.formModal.mode]),a=()=>{d.submitFormValues(),d.setFormModalVisible(!1)},u=()=>{d.setFormModalVisible(!1)},r=[{label:"\u8BFE\u7A0B",path:"title",type:"input",span:8},{label:"\u65F6\u95F4",path:"range",type:"date-time-range",span:16},{label:"\u5B66\u751F",path:"associates",type:"select-multiple",span:24,option:C(()=>Array.from(d.getAssociates()).map(n=>({label:n,value:n})))},{label:"\u91CD\u590D",path:"repeatMode",type:"radio-group",option:[{label:"\u65E0",value:h.NON_REPEAT},{label:"\u6BCF\u5929",value:h.PER_DAY},{label:"\u6BCF\u5468",value:h.PER_WEEK},{label:"\u81EA\u5B9A\u4E49",value:h.CUSTOM}],span:24},{label:"\u91CD\u590D\u6B21\u6570",path:"repeatTimes",type:"input-number",span:8,disabled:C(()=>s.value.repeatMode===h.NON_REPEAT)},{label:"\u91CD\u590D\u95F4\u9694",path:"repeatGap",type:"input-number",span:8,disabled:C(()=>s.value.repeatMode!==h.CUSTOM)},{label:"\u95F4\u9694\u5355\u4F4D",path:"repeatUnit",type:"select",option:[{label:"\u5929",value:f.DAY},{label:"\u5468",value:f.WEEK}],span:8,disabled:C(()=>s.value.repeatMode!==h.CUSTOM)}];return pe(()=>s.value.repeatMode,n=>{switch(n){case h.NON_REPEAT:d.updateFormValuesByKey("repeatTimes",0),d.updateFormValuesByKey("repeatGap",0),d.updateFormValuesByKey("repeatUnit",f.DAY);break;case h.PER_DAY:d.updateFormValuesByKey("repeatGap",1),d.updateFormValuesByKey("repeatUnit",f.DAY);break;case h.PER_WEEK:d.updateFormValuesByKey("repeatGap",1),d.updateFormValuesByKey("repeatUnit",f.WEEK);break}}),(n,l)=>(_(),v(o(fe),{preset:"card",show:o(d).state.formModal.visible,"onUpdate:show":l[1]||(l[1]=m=>o(d).state.formModal.visible=m),style:{width:"700px"},title:o(p),"mask-closable":!1},{default:i(()=>[c(o(Ye),{items:r,"label-placement":"left","action-justify":"end","form-value":o(s),"onUpdate:form-value":l[0]||(l[0]=m=>ce(s)?s.value=m:null),onConfirm:a,onCancel:u},null,8,["form-value"])]),_:1},8,["show","title"]))}});const je={class:"root"},Je=b({setup(e){return me(()=>{d.loadFromLocalStorage()}),(t,s)=>(_(),T("div",je,[c(o(Ee),{locale:o(_e),"date-locale":o(he)},{default:i(()=>[c(o(w),{"y-gap":24,cols:1},{default:i(()=>[c(o(R),null,{default:i(()=>[c(Le)]),_:1})]),_:1}),c(Ke)]),_:1},8,["locale","date-locale"])]))}});var He=A(Je,[["__scopeId","data-v-38d0ff78"]]);const Ge=b({setup(e){return(t,s)=>(_(),v(He))}});ye(Ge).mount("#app");
